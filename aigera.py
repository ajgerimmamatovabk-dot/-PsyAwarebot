import asyncio
import os
from aiogram import Bot, Dispatcher, types
from aiogram.types import (
    ReplyKeyboardMarkup,
    KeyboardButton,
    ReplyKeyboardRemove,
    FSInputFile
)
from aiogram.filters import CommandStart, Command
from aiogram.fsm.state import State, StatesGroup
from aiogram.fsm.context import FSMContext
from openpyxl import Workbook, load_workbook

# --- –¢–û–ö–ï–ù –ò –ù–ê–°–¢–†–û–ô–ö–ò ---
TOKEN = "8540730921:AAFQoHoHx6v3b2fS1GIec5SbVW5YZjtVCaM"
bot = Bot(token=TOKEN)
dp = Dispatcher()

EXCEL_FILE = "results.xlsx"

questions = [
    "–°—á–∏—Ç–∞–µ—Ç–µ –ª–∏ –≤—ã, —á—Ç–æ –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —á–∞—â–µ –≤–æ–∑–Ω–∏–∫–∞—é—Ç –∏–∑-–∑–∞ –ª–µ–Ω–∏?",
    "–ë—ã–ª–æ –±—ã –≤–∞–º –Ω–µ–ª–æ–≤–∫–æ –æ–±—Ä–∞—Ç–∏—Ç—å—Å—è –∑–∞ –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–π –ø–æ–º–æ—â—å—é?",
    "–°—Ç–∞–ª–∏ –±—ã –≤—ã –º–µ–Ω—å—à–µ —É–≤–∞–∂–∞—Ç—å —Å–µ–±—è –ø–æ—Å–ª–µ –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ –ø—Å–∏—Ö–æ–ª–æ–≥—É?",
    "–°–∫—Ä—ã–ª–∏ –±—ã –≤—ã —Ñ–∞–∫—Ç –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç—É?",
    "–ò–∑–º–µ–Ω–∏–ª–æ—Å—å –±—ã –º–Ω–µ–Ω–∏–µ –∑–Ω–∞–∫–æ–º—ã—Ö –æ –≤–∞—Å –≤ —Ö—É–¥—à—É—é —Å—Ç–æ—Ä–æ–Ω—É?",
    "–ú–æ–∂–µ—Ç –ª–∏ –æ–±—Ä–∞—â–µ–Ω–∏–µ –ø–æ–≤–ª–∏—è—Ç—å –Ω–∞ —Ä–∞–±–æ—Ç—É/—É—á—ë–±—É?",
    "–°—á–∏—Ç–∞–µ—Ç–µ –ª–∏ –≤—ã –ø—Ä–µ–ø–∞—Ä–∞—Ç—ã —á–∞—â–µ –≤—Ä–µ–¥–Ω—ã–º–∏?",
    "–°—á–∏—Ç–∞–µ—Ç–µ –ª–∏ –≤—ã –ø—Å–∏—Ö–æ—Ç–µ—Ä–∞–ø–∏—é —Ç—Ä–∞—Ç–æ–π –≤—Ä–µ–º–µ–Ω–∏?"
]

# --- –ö–õ–ê–í–ò–ê–¢–£–†–´ ---
start_kb = ReplyKeyboardMarkup(keyboard=[[KeyboardButton(text="–ù–∞—á–∞—Ç—å –æ–ø—Ä–æ—Å")]], resize_keyboard=True)
yes_no_kb = ReplyKeyboardMarkup(keyboard=[[KeyboardButton(text="–î–∞"), KeyboardButton(text="–ù–µ—Ç")]],
                                resize_keyboard=True)


class Survey(StatesGroup):
    waiting_start = State()
    age = State()
    question = State()


# --- –§–£–ù–ö–¶–ò–ò EXCEL ---
def init_excel():
    if not os.path.exists(EXCEL_FILE):
        wb = Workbook()
        ws = wb.active
        ws.append(["–í–æ–∑—Ä–∞—Å—Ç"] + [f"–≤–æ–ø—Ä–æ—Å{i + 1}" for i in range(len(questions))])
        wb.save(EXCEL_FILE)


def save_to_excel(row):
    wb = load_workbook(EXCEL_FILE)
    ws = wb.active
    ws.append(row)
    wb.save(EXCEL_FILE)


# --- –•–ï–ù–î–õ–ï–†–´ ---

@dp.message(Command("export"))
async def export_results(message: types.Message):
    """–ö–æ–º–∞–Ω–¥–∞ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ñ–∞–π–ª–∞ —Å–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π"""
    if os.path.exists(EXCEL_FILE):
        file = FSInputFile(EXCEL_FILE)
        await message.answer_document(file, caption="üìä –í–æ—Ç –∞–∫—Ç—É–∞–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Å –æ—Ç–≤–µ—Ç–∞–º–∏.")
    else:
        await message.answer("‚ùå –§–∞–π–ª —Å –æ—Ç–≤–µ—Ç–∞–º–∏ –ø–æ–∫–∞ –ø—É—Å—Ç.")


@dp.message(CommandStart())
async def start_handler(message: types.Message, state: FSMContext):
    await state.clear()
    text = (
        "–ü—Ä–∏–≤–µ—Ç! –Ø ‚Äî –±–æ—Ç-–∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å.\n\n"
        "–°–µ–π—á–∞—Å —è —Å–æ–±–∏—Ä–∞—é –¥–∞–Ω–Ω—ã–µ –¥–ª—è –Ω–∞—É—á–Ω–æ–π —Ä–∞–±–æ—Ç—ã –æ —Å—Ç–∏–≥–º–∞—Ç–∏–∑–∞—Ü–∏–∏ "
        "–ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–π –∏ –ø—Å–∏—Ö–∏–∞—Ç—Ä–∏—á–µ—Å–∫–æ–π –ø–æ–º–æ—â–∏.\n\n"
        "–û–ø—Ä–æ—Å –ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–Ω–æ–Ω–∏–º–Ω—ã–π. –ú–Ω–µ –≤–∞–∂–Ω—ã —Ç–æ–ª—å–∫–æ –≤–∞—à–∏ —á–µ—Å—Ç–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã."
    )
    if os.path.exists("welcome.jpg"):
        await message.answer_photo(photo=FSInputFile("welcome.jpg"), caption=text, reply_markup=start_kb)
    else:
        await message.answer(text, reply_markup=start_kb)
    await state.set_state(Survey.waiting_start)


@dp.message(Survey.waiting_start)
async def begin_survey(message: types.Message, state: FSMContext):
    if message.text != "–ù–∞—á–∞—Ç—å –æ–ø—Ä–æ—Å":
        await message.answer("–ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É '–ù–∞—á–∞—Ç—å –æ–ø—Ä–æ—Å'.")
        return
    await message.answer("–û—Ç–ª–∏—á–Ω–æ! –í–≤–µ–¥–∏—Ç–µ –≤–∞—à –≤–æ–∑—Ä–∞—Å—Ç:", reply_markup=ReplyKeyboardRemove())
    await state.set_state(Survey.age)


@dp.message(Survey.age)
async def get_age(message: types.Message, state: FSMContext):
    if not message.text.isdigit():
        await message.answer("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –≤–æ–∑—Ä–∞—Å—Ç —á–∏—Å–ª–æ–º.")
        return
    await state.update_data(age=message.text, answers=[], q_index=0)
    await state.set_state(Survey.question)
    await message.answer(f"–í–æ–ø—Ä–æ—Å 1 –∏–∑ {len(questions)}:\n\n{questions[0]}", reply_markup=yes_no_kb)


@dp.message(Survey.question)
async def handle_questions(message: types.Message, state: FSMContext):
    if message.text not in ["–î–∞", "–ù–µ—Ç"]:
        await message.answer("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫–∏ –î–∞/–ù–µ—Ç.")
        return

    data = await state.get_data()
    q_index = data["q_index"]
    answers = data["answers"]
    answers.append(message.text)
    q_index += 1

    if q_index < len(questions):
        await state.update_data(q_index=q_index, answers=answers)
        await message.answer(
            f"–í–æ–ø—Ä–æ—Å {q_index + 1} –∏–∑ {len(questions)}:\n\n{questions[q_index]}",
            reply_markup=yes_no_kb
        )
    else:
        save_to_excel([data["age"]] + answers)
        await message.answer("–°–ø–∞—Å–∏–±–æ –∑–∞ —á–µ—Å—Ç–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã! –¢—ã –Ω–µ –æ–¥–∏–Ω–æ–∫(–∞) –≤ —Å–≤–æ–∏—Ö –æ–ø–∞—Å–µ–Ω–∏—è—Ö. –ú–Ω–æ–≥–∏–µ –ª—é–¥–∏ —á—É–≤—Å—Ç–≤—É—é—Ç —Ç–æ –∂–µ —Å–∞–º–æ–µ –∏–∑-–∑–∞ –æ–±–∏–ª–∏—è –º–∏—Ñ–æ–≤. –î–∞–≤–∞–π —Ä–∞–∑–±–µ—Ä–µ–º—Å—è, —á—Ç–æ –∏–∑ —ç—Ç–æ–≥–æ –ø—Ä–∞–≤–¥–∞, –∞ —á—Ç–æ ‚Äî –ø—Ä–æ—Å—Ç–æ —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ —Å—Ç–µ—Ä–µ–æ—Ç–∏–ø—ã. ",
                             reply_markup=ReplyKeyboardRemove())
        await asyncio.sleep(1.5)

        # –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ –±–ª–æ–∫–∏
        blocks = [

            """–ë–ª–æ–∫ 1: –°–∏–ª–∞ –∏–ª–∏ —Å–ª–∞–±–æ—Å—Ç—å? (–û—Ç—Ä–∞–±–æ—Ç–∫–∞ –≤–æ–ø—Ä–æ—Å–æ–≤ ‚Ññ1, 2, 3)
            –°—É—Ç—å: –£–±–∏—Ä–∞–µ–º —á—É–≤—Å—Ç–≤–æ –≤–∏–Ω—ã –∏ —Å–∞–º–æ—Å—Ç–∏–≥–º—É.
    
            ‚óè –ú–∏—Ñ: ¬´–ü—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã ‚Äî —ç—Ç–æ –æ—Ç –ª–µ–Ω–∏ –∏–ª–∏ —Å–ª–∞–±–æ—Å—Ç–∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞¬ª.
            ‚óè –†–µ–∞–ª—å–Ω–æ—Å—Ç—å: –î–µ–ø—Ä–µ—Å—Å–∏—è –∏ –ø–∞–Ω–∏—á–µ—Å–∫–∏–µ –∞—Ç–∞–∫–∏ (–ü–ê) –∏–º–µ—é—Ç –±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫—É—é –æ—Å–Ω–æ–≤—É. –≠—Ç–æ —Å–±–æ–π –≤ —Ä–∞–±–æ—Ç–µ –Ω–µ–π—Ä–æ–º–µ–¥–∏–∞—Ç–æ—Ä–æ–≤ (—Å–µ—Ä–æ—Ç–æ–Ω–∏–Ω–∞, –¥–æ—Ñ–∞–º–∏–Ω–∞) –∏ —Ä–µ–∞–∫—Ü–∏—è –Ω–µ—Ä–≤–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –Ω–∞ —Å—Ç—Ä–µ—Å—Å.
            ‚óè –í–∞–∂–Ω–æ: –û–±—Ä–∞—â–µ–Ω–∏–µ –∑–∞ –ø–æ–º–æ—â—å—é ‚Äî —ç—Ç–æ –Ω–µ ¬´—Å–¥–∞—á–∞ –ø–æ–∑–∏—Ü–∏–π¬ª, –∞ –∞–∫—Ç–∏–≤–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã. –≠—Ç–æ —Ç—Ä–µ–±—É–µ—Ç –≥–æ—Ä–∞–∑–¥–æ –±–æ–ª—å—à–µ–≥–æ –º—É–∂–µ—Å—Ç–≤–∞, —á–µ–º –ø–æ–ø—ã—Ç–∫–∏ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ ¬´—Ç–µ—Ä–ø–µ—Ç—å¬ª. –í–∞—à–µ —Å–∞–º–æ—É–≤–∞–∂–µ–Ω–∏–µ –Ω–µ –¥–æ–ª–∂–Ω–æ –∑–∞–≤–∏—Å–µ—Ç—å –æ—Ç –±–æ–ª–µ–∑–Ω–∏, —Ç–∞–∫ –∂–µ –∫–∞–∫ –æ–Ω–æ –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–æ–≥–æ, –∑–∞–±–æ–ª–µ–ª–∏ –≤—ã –≥—Ä–∏–ø–ø–æ–º –∏–ª–∏ –Ω–µ—Ç.
            """,

            """–ë–ª–æ–∫ 2: –¢–∞–π–Ω–æ–µ –Ω–µ —Å—Ç–∞–Ω–µ—Ç —è–≤–Ω—ã–º (–û—Ç—Ä–∞–±–æ—Ç–∫–∞ –≤–æ–ø—Ä–æ—Å–æ–≤ ‚Ññ4, 5, 6)
            –°—É—Ç—å: –°–Ω–∏–º–∞–µ–º —Å—Ç—Ä–∞—Ö —Å–æ—Ü–∏–∞–ª—å–Ω–æ–π –∏–∑–æ–ª—è—Ü–∏–∏ –∏ –ø—Ä–æ–±–ª–µ–º —Å —É—á–µ–±–æ–π/—Ä–∞–±–æ—Ç–æ–π.
    
            ‚óè –û –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏: –û–±—Ä–∞—â–µ–Ω–∏–µ –∫ —á–∞—Å—Ç–Ω–æ–º—É –ø—Å–∏—Ö–æ–ª–æ–≥—É –∏–ª–∏ –ø—Å–∏—Ö–æ—Ç–µ—Ä–∞–ø–µ–≤—Ç—É –ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–Ω–æ–Ω–∏–º–Ω–æ. –ù–∏–∫—Ç–æ –Ω–µ —É–∑–Ω–∞–µ—Ç –æ–± —ç—Ç–æ–º, –µ—Å–ª–∏ –≤—ã —Å–∞–º–∏ –Ω–µ —Ä–µ—à–∏—Ç–µ —Ä–∞—Å—Å–∫–∞–∑–∞—Ç—å.
            ‚óè –£—á–µ–±–∞ –∏ —Ä–∞–±–æ—Ç–∞: –í —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π –∫—É–ª—å—Ç—É—Ä–µ –∑–∞–±–æ—Ç–∞ –æ –º–µ–Ω—Ç–∞–ª—å–Ω–æ–º –∑–¥–æ—Ä–æ–≤—å–µ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –ø—Ä–∏–∑–Ω–∞–∫–æ–º –æ—Å–æ–∑–Ω–∞–Ω–Ω–æ—Å—Ç–∏. –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –∫—Ä—É–ø–Ω—ã—Ö –∫–æ–º–ø–∞–Ω–∏–π –∏ –≤—É–∑–æ–≤ —Ü–µ–Ω—è—Ç —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —É–º–µ—é—Ç –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å —Å–≤–æ–π —Ä–µ—Å—É—Ä—Å, –∞ –Ω–µ –¥–æ–≤–æ–¥—è—Ç —Å–µ–±—è –¥–æ –≤—ã–≥–æ—Ä–∞–Ω–∏—è.
            ‚óè –û–∫—Ä—É–∂–µ–Ω–∏–µ: –ù–∞—Å—Ç–æ—è—â–∏–µ –±–ª–∏–∑–∫–∏–µ –ª—é–¥–∏, —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ, –∑–∞–º–µ—Ç—è—Ç, —á—Ç–æ –≤–∞–º —Å—Ç–∞–ª–æ –ª–µ–≥—á–µ –∏ –≤—ã —Å—Ç–∞–ª–∏ ¬´—Å–æ–±–æ–π¬ª, –∞ –Ω–µ –±—É–¥—É—Ç –æ—Å—É–∂–¥–∞—Ç—å –∑–∞ —Å–∞–º —Ñ–∞–∫—Ç –ª–µ—á–µ–Ω–∏—è.
            """,

            """–ë–ª–æ–∫ 3: –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç ¬´—Ä–µ–º–æ–Ω—Ç¬ª –ø—Å–∏—Ö–∏–∫–∏ (–û—Ç—Ä–∞–±–æ—Ç–∫–∞ –≤–æ–ø—Ä–æ—Å–æ–≤ ‚Ññ7, 8)
            –°—É—Ç—å: –†–µ–∞–±–∏–ª–∏—Ç–∏—Ä—É–µ–º –º–µ—Ç–æ–¥—ã –ª–µ—á–µ–Ω–∏—è.
    
            ‚óè –ü—Ä–æ –ª–µ–∫–∞—Ä—Å—Ç–≤–∞ (–ê–Ω—Ç–∏–¥–µ–ø—Ä–µ—Å—Å–∞–Ω—Ç—ã): –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –ø—Ä–µ–ø–∞—Ä–∞—Ç—ã ‚Äî —ç—Ç–æ –Ω–µ ¬´–Ω–∞—Ä–∫–æ—Ç–∏–∫–∏¬ª. –û–Ω–∏ –Ω–µ –º–µ–Ω—è—é—Ç –≤–∞—à—É –ª–∏—á–Ω–æ—Å—Ç—å –∏ –Ω–µ –≤—ã–∑—ã–≤–∞—é—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏, –µ—Å–ª–∏ –ø–æ–¥–æ–±—Ä–∞–Ω—ã –≤—Ä–∞—á–æ–º. –ò—Ö –∑–∞–¥–∞—á–∞ ‚Äî –ø—Ä–æ—Å—Ç–æ –ø–æ–º–æ—á—å –º–æ–∑–≥—É —Å–Ω–æ–≤–∞ –Ω–∞—á–∞—Ç—å –≤—ã—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –Ω—É–∂–Ω—ã–µ –≤–µ—â–µ—Å—Ç–≤–∞ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ.
            ‚óè –ü—Ä–æ –ø—Å–∏—Ö–æ—Ç–µ—Ä–∞–ø–∏—é: –≠—Ç–æ –Ω–µ ¬´–ø—Ä–æ—Å—Ç–æ —Ä–∞–∑–≥–æ–≤–æ—Ä—ã –∑–∞ –¥–µ–Ω—å–≥–∏¬ª. –≠—Ç–æ –Ω–∞—É—á–Ω–æ –¥–æ–∫–∞–∑–∞–Ω–Ω—ã–µ –º–µ—Ç–æ–¥–∏–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ö–ü–¢), –∫–æ—Ç–æ—Ä—ã–µ –æ–±—É—á–∞—é—Ç –º–æ–∑–≥ –Ω–æ–≤—ã–º —Å–ø–æ—Å–æ–±–∞–º —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ —Å—Ç—Ä–µ—Å—Å. –≠—Ç–æ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏—è –≤ –≤–∞—à–µ –≤—Ä–µ–º—è: —Ä–µ—à–∏–≤ –ø—Ä–æ–±–ª–µ–º—É —Å–µ–π—á–∞—Å, –≤—ã —ç–∫–æ–Ω–æ–º–∏—Ç–µ –≥–æ–¥—ã –∂–∏–∑–Ω–∏, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥–ª–∏ –±—ã –ø—Ä–æ–≤–µ—Å—Ç–∏ –≤ —Ç—Ä–µ–≤–æ–≥–µ.
            """,

            """–ë–ª–æ–∫ 4: –ß—Ç–æ –¥–µ–ª–∞—Ç—å –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å?
            ¬´–î–µ–ø—Ä–µ—Å—Å–∏—è –∏ –ø–∞–Ω–∏–∫–∞ ‚Äî —ç—Ç–æ –Ω–µ –ø—Ä–∏–≥–æ–≤–æ—Ä, –∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ —É—Å–ø–µ—à–Ω–æ –ª–µ—á–∞—Ç—Å—è. –í–æ—Ç —Ç–≤–æ–π –ø–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π:¬ª
    
            1. –ü—Ä–æ–≤–µ—Ä—å —Å–∏–º–ø—Ç–æ–º—ã: –ï—Å–ª–∏ –ø–ª–æ—Ö–æ–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ –∏–ª–∏ —Ç—Ä–µ–≤–æ–≥–∞ –¥–ª—è—Ç—Å—è –±–æ–ª–µ–µ 2 –Ω–µ–¥–µ–ª—å ‚Äî –ø–æ—Ä–∞ –æ–±—Ä–∞—Ç–∏—Ç—å—Å—è –∫ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç—É.
            2. –í—ã–±–µ—Ä–∏ –≤—Ä–∞—á–∞: –ü—Å–∏—Ö–æ–ª–æ–≥ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å —ç–º–æ—Ü–∏—è–º–∏, –ø—Å–∏—Ö–æ—Ç–µ—Ä–∞–ø–µ–≤—Ç ‚Äî —Å —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏ –∏ –ø–æ–≤–µ–¥–µ–Ω–∏–µ–º.
            3. –ù–µ –±–æ–π—Å—è —Å–ø—Ä–∞—à–∏–≤–∞—Ç—å: –¢—ã –∏–º–µ–µ—à—å –ø—Ä–∞–≤–æ –∑–Ω–∞—Ç—å –≤—Å—ë –æ –º–µ—Ç–æ–¥–∞—Ö –ª–µ—á–µ–Ω–∏—è –∏ –∫–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞.
            """,

            """–¢–µ–ø–µ—Ä—å –º—ã –ø–µ—Ä–µ–π–¥–µ–º –∫ —Ñ–∏–Ω–∞–ª—å–Ω–æ–π —á–∞—Å—Ç–∏ –æ–ø—Ä–æ—Å–∞.
            –¢–≤–æ–∏ –æ—Ç–≤–µ—Ç—ã –ø–æ–º–æ–≥—É—Ç –Ω–∞–º –ø–æ–Ω—è—Ç—å, —Å—Ç–∞–ª–∞ –ª–∏ –∫–∞—Ä—Ç–∏–Ω–∫–∞ —è—Å–Ω–µ–µ!
                        """

        ]

        for block in blocks:
            await message.answer(block, parse_mode="Markdown")
            await asyncio.sleep(1)

        await state.clear()


async def main():
    init_excel()
    await dp.start_polling(bot)


if __name__ == "__main__":
    try:
        asyncio.run(main())
    except KeyboardInterrupt:
        pass